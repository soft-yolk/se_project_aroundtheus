!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formEl=t,this._inputList=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._submitButton=this._formEl.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_checkFormValidity(){return this._inputList.every((e=>e.validity.valid))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_toggleButtonState(){this._checkFormValidity()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class t{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class s extends t{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this.handleFormSubmit=t}close(){this._popupForm.reset(),super.close()}getInputValues(){const e=this._popupElement.querySelectorAll(".modal__input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this.handleFormSubmit(this.getInputValues()),this.close()}))}setLoading(e){this._submitButton.textContent=e?"Saving...":this._submitButtonText}}class r{constructor(e,t,s,r,n){let{name:i,link:o,_id:a,isLiked:l}=e;this._name=i,this._link=o,this._id=a,this.isLiked=l,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteButton=r,this._handleLikeClick=n}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".elements__card").cloneNode(!0)}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".elements__like-button"),this._likeButton.addEventListener("click",(()=>{this.handleLikeIcon()})),this._cardElement.querySelector(".elements__trash-button").addEventListener("click",(()=>{this._handleDeleteButton(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._cardImage)}))}handleLikeIcon(){this._likeButton.classList.toggle("elements__like-button_active")}updateLiked(){this.isLiked?this._likeButton.classList.add("elements__like-button_active"):this._likeButton.classList.remove("elements__like-button_active")}setLikeStatus(e){this.isLiked=e,this.updateLiked()}getView(){return this._cardElement=this._getTemplate(),this.renderCard(),this._setEventListeners(),this.updateLiked(),this._cardElement}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}renderCard(){this._cardImage=this._cardElement.querySelector(".elements__image"),this._cardTitle=this._cardElement.querySelector(".elements__title"),this._likeButton=this._cardElement.querySelector(".elements__like-button"),this._cardTitle.textContent=this._name,this._cardImage.alt=this._name,this._cardImage.src=this._link}}const n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};document.querySelector(".elements__cards");const i=document.querySelector("#profile-edit-button"),o=document.querySelector(".profile__add-button"),a=document.querySelector("#add-card-modal").querySelector(".modal__form"),l=document.querySelector("#profile-picture-modal").querySelector(".modal__form"),c=document.querySelector("#profile-edit-modal").querySelector(".modal__form"),d=document.querySelector("#name-modal-input"),h=document.querySelector("#description-modal-input"),u=document.querySelector(".profile__image"),_=document.querySelector(".profile__icon"),m=document.querySelector("#profile-picture-modal").querySelector(".modal__button"),p=new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._aboutElement=document.querySelector(t),this._avatar=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._aboutElement.textContent}}setUserInfo(e){let{name:t,about:s}=e;this._nameElement.textContent=t,this._aboutElement.textContent=s}setUserAvatar(e){this._avatar.src=e}}(".profile__name",".profile__description",".profile__image"),v=new class{constructor(e){this.baseUrl=e.baseUrl,this.headers=e.headers}_checkServerResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(this.baseUrl+"/cards",{method:"GET",headers:this.headers}).then(this._checkServerResponse)}getUserInfo(){return fetch(this.baseUrl+"/users/me",{method:"GET",headers:this.headers}).then(this._checkServerResponse)}updateProfileInfo(e,t){return fetch(this.baseUrl+"/users/me",{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(this._checkServerResponse)}updateAvatar(e){return fetch(this.baseUrl+"/users/me/avatar",{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._checkServerResponse)}addCard(e){let{name:t,link:s}=e;return fetch(this.baseUrl+"/cards",{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:s})}).then(this._checkServerResponse)}deleteCard(e){return fetch(this.baseUrl+`/cards/${e}`,{method:"DELETE",headers:this.headers,body:JSON.stringify({_id:e})}).then(this._checkServerResponse)}updateLike(e){return fetch(this.baseUrl+`/cards/${e}/likes`,{method:"PUT",headers:this.headers}).then(this._checkServerResponse)}removeLike(e){return fetch(this.baseUrl+`/cards/${e}/likes`,{method:"DELETE",headers:this.headers}).then(this._checkServerResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"7b855de8-b589-492b-9e1c-b631d0b0f4c2","Content-Type":"application/json"}}),E=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{E.addItem(b(e))}},".elements__cards");function S(e,t){e.textContent=t}function b(e){const t=new r(e,"#element-template",(()=>function(e){f.open(e.name,e.link)}(e)),y,L);return t.getView()}v.getInitialCards().then((e=>{E.renderItems(e.reverse()),console.log(e)})).catch((e=>{console.error(e)})),v.getUserInfo().then((e=>{p.setUserInfo(e),p.setUserAvatar(e.avatar)})).catch((e=>{console.error(e)}));const f=new class extends t{constructor(e){super(e),this._previewImage=this._popupElement.querySelector(".modal__preview-image"),this._imageCaption=this._popupElement.querySelector(".modal__title")}open(e,t){this._previewImage.src=t,this._previewImage.alt=e,this._imageCaption.textContent=e,super.open()}}("#modal-preview");function L(e){return e.isLiked?v.removeLike(e._id).then((()=>{e.setLikeStatus(!1)})).catch((e=>{console.error(e)})):v.updateLike(e._id).then((()=>{e.setLikeStatus(!0)})).catch((e=>{console.error(e)}))}f.setEventListeners();const k=new class extends t{constructor(e,t){super(e),this._confirmDelete=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}setEventListeners(){super.setEventListeners(),this._confirmDelete.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(),this.close()}))}setSubmitAction(e){this._handleFormSubmit=e}}("#confirm-modal");function y(e){k.open(),k.setSubmitAction((()=>{v.deleteCard(e._id).then((()=>{k.close(),e.handleDeleteCard()})).catch((e=>{console.log(e)}))})),console.log(e)}k.setEventListeners(),_.addEventListener("click",(()=>{w.open()})),u.addEventListener("click",(()=>{w.open(),q.resetValidation()})),i.addEventListener("click",(()=>{const e=p.getUserInfo();d.value=e.name,h.value=e.job,B.open(),C.resetValidation()})),o.addEventListener("click",(()=>{g.resetValidation(),I.open()}));const g=new e(n,a);g.enableValidation();const C=new e(n,c);C.enableValidation();const q=new e(n,l);q.enableValidation();const I=new s("#add-card-modal",(function(e){v.addCard(e).then((e=>{console.log(e),E.addItem(b(e)),I.close()})).catch((e=>{console.log(e)}))}));I.setEventListeners();const B=new s("#profile-edit-modal",(function(e){let{name:t,about:s}=e;return B.setLoading(!0),v.updateProfileInfo(t,s).then((e=>{p.setUserInfo(e),B.close()})).finally((()=>{}))}));B.setEventListeners();const w=new s("#profile-picture-modal",(function(e){S(m,"Saving..."),console.log(e),v.updateAvatar(e.link).then((t=>{p.setUserAvatar(e.link),w.close()})).catch((e=>{console.log(e).finally((()=>{S(m,"Save")}))}))}));w.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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IjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gIH1cblxuICBfY2hlY2tGb3JtVmFsaWRpdHkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5ldmVyeSgoaW5wdXQpID0+IGlucHV0LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgY29uc3QgZm91bmRJbnZhbGlkID0gdGhpcy5fY2hlY2tGb3JtVmFsaWRpdHkoKTtcblxuICAgIGlmIChmb3VuZEludmFsaWQpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChldmVudCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICAgIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgLy9jb2xsZWN0cyBkYXRhIGZyb20gYWxsIHRoZSBpbnB1dCBmaWVsZHMgYW5kIHJldHVybnMgdGhhdCBkYXRhIGFzIGFuIG9iamVjdFxuICBnZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgY29uc3QgZGF0YSA9IHt9O1xuICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgZGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBkYXRhO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmhhbmRsZUZvcm1TdWJtaXQodGhpcy5nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUJ1dHRvbixcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5faWQgPSBfaWQ7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uID0gaGFuZGxlRGVsZXRlQnV0dG9uO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2NhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5lbGVtZW50c19fbGlrZS1idXR0b25cIlxuICAgICk7XG5cbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmhhbmRsZUxpa2VJY29uKCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX3RyYXNoLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbih0aGlzKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2NhcmRJbWFnZSk7XG4gICAgfSk7XG4gIH1cblxuICBoYW5kbGVMaWtlSWNvbigpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJlbGVtZW50c19fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgLy8gaXNMaWtlZCgpIHtcbiAgLy8gICByZXR1cm4gdGhpcy5faXNMaWtlZDtcbiAgLy8gfVxuXG4gIHVwZGF0ZUxpa2VkKCkge1xuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImVsZW1lbnRzX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImVsZW1lbnRzX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgc2V0TGlrZVN0YXR1cyhpc0xpa2VkKSB7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLnVwZGF0ZUxpa2VkKCk7XG4gIH1cblxuICAvLyBfaGFuZGxlT3BlblByZXZpZXcoKSB7XG4gIC8vICAgcHJldmlld0ltYWdlTW9kYWwuc3JjID0gdGhpcy5fbGluaztcbiAgLy8gICBwcmV2aWV3SW1hZ2VNb2RhbC5hbHQgPSB0aGlzLl9uYW1lO1xuICAvLyAgIHByZXZpZXdUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gIC8vICAgb3BlblBvcHVwKHByZXZpZXdJbWFnZU1vZGFsV2luZG93KTtcbiAgLy8gICAvLyBwcmV2aWV3SW1hZ2VNb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAvLyB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5yZW5kZXJDYXJkKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLnVwZGF0ZUxpa2VkKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICByZW5kZXJDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudHNfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZWxlbWVudHNfX2xpa2UtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2NhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gIH1cbn1cbiIsIi8vIGV4cG9ydCBmdW5jdGlvbiBjbG9zZUJ5RXNjYXBlKGV2dCkge1xuLy8gICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuLy8gICAgIGNvbnN0IG9wZW5lZFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4vLyAgICAgY2xvc2VQb3B1cChvcGVuZWRQb3B1cCk7XG4vLyAgIH1cbi8vIH1cblxuLy8gZXhwb3J0IGZ1bmN0aW9uIGNsb3NlUG9wdXAobW9kYWwpIHtcbi8vICAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbi8vICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VCeUVzY2FwZSk7XG4vLyB9XG5cbi8vIGV4cG9ydCBmdW5jdGlvbiBvcGVuUG9wdXAobW9kYWwpIHtcbi8vICAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbi8vICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VCeUVzY2FwZSk7XG4vLyB9XG4vLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJMYXRlbWFyXCIsXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxuLy8gICB9LFxuLy8gXTtcblxuY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmV4cG9ydCB7IGNvbmZpZyB9O1xuIiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBjb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcblxuLy8gY29uc3QgY2FyZERhdGEgPSB7XG4vLyAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4vLyAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbi8vIH07XG5cbi8vU0VMRUNUT1JTLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuY29uc3QgY2FyZHNXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50c19fY2FyZHNcIik7XG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5jb25zdCBhZGRDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xuY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcblxuY29uc3QgZWRpdFByb2ZpbGVQaWN0dXJlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLXBpY3R1cmUtbW9kYWxcIlxuKTtcbmNvbnN0IGVkaXRQcm9maWxlUGljdHVyZUZvcm0gPVxuICBlZGl0UHJvZmlsZVBpY3R1cmVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZS1tb2RhbC1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjZGVzY3JpcHRpb24tbW9kYWwtaW5wdXRcIlxuKTtcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XG5jb25zdCBwcm9maWxlSW1hZ2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ljb25cIik7XG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1waWN0dXJlLW1vZGFsXCIpO1xuY29uc3QgYXZhdGFyTW9kYWxCdXR0b24gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4vLyBjb25zdCBkZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRzX190cmFzaC1idXR0b25cIik7XG5cbi8vU2VjdGlvbiBSZW5kZXJcblxuLy8gY29uc3QgY2FyZHNTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4vLyAgIHtcbi8vICAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcbi8vICAgfSxcbi8vICAgXCIuZWxlbWVudHNfX2NhcmRzXCJcbi8vICk7XG5cbi8vVXNlciBJbmZvIFJlbmRlclxuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgXCIucHJvZmlsZV9fbmFtZVwiLFxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICBcIi5wcm9maWxlX19pbWFnZVwiXG4pO1xuXG4vL0FQSSBSZW5kZXJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjdiODU1ZGU4LWI1ODktNDkyYi05ZTFjLWI2MzFkMGIwZjRjMlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmNvbnN0IGNhcmRMaXN0ID0gbmV3IFNlY3Rpb24oXG4gIHtcbiAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICBjYXJkTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQoY2FyZERhdGEpKTtcbiAgICB9LFxuICB9LFxuICBcIi5lbGVtZW50c19fY2FyZHNcIlxuKTtcblxuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigocmVzKSA9PiB7XG4gICAgLy8gY29uc29sZS5sb2coXCI+PkluaXRpYWwgQ2FyZHNcIiwgY2FyZERhdGEpO1xuICAgIGNhcmRMaXN0LnJlbmRlckl0ZW1zKHJlcy5yZXZlcnNlKCkpO1xuICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcblxuYXBpXG4gIC5nZXRVc2VySW5mbygpXG4gIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcbiAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcblxuLy9GVU5DVElPTlMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmZ1bmN0aW9uIHNldEJ1dHRvblRleHQoYnV0dG9uLCB0ZXh0KSB7XG4gIGJ1dHRvbi50ZXh0Q29udGVudCA9IHRleHQ7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIGNhcmREYXRhLFxuICAgIFwiI2VsZW1lbnQtdGVtcGxhdGVcIixcbiAgICAoKSA9PiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSxcbiAgICBoYW5kbGVEZWxldGVCdXR0b24sXG4gICAgaGFuZGxlQ2FyZExpa2VcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuXG4vLyBmdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4vLyAgIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcbi8vICAgc2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuLy8gfVxuXG4vL0ltYWdlIFBvcHVwIFJlbmRlclxuXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI21vZGFsLXByZXZpZXdcIik7XG5pbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcbiAgaW1hZ2VQb3B1cC5vcGVuKGNhcmREYXRhLm5hbWUsIGNhcmREYXRhLmxpbmspO1xufVxuXG4vLyBmdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShjYXJkKSB7XG4vLyAgIGFwaVxuLy8gICAgIC5saWtlQ2FyZChjYXJkLl9pZCwgY2FyZC5pc0xpa2VkKCkpXG4vLyAgICAgLnRoZW4oKCkgPT4ge1xuLy8gICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xuLy8gICAgIH0pXG4vLyAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuLy8gfVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShjYXJkKSB7XG4gIGlmICghY2FyZC5pc0xpa2VkKSB7XG4gICAgcmV0dXJuIGFwaVxuICAgICAgLnVwZGF0ZUxpa2UoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQuc2V0TGlrZVN0YXR1cyh0cnVlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYXBpXG4gICAgICAucmVtb3ZlTGlrZShjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5zZXRMaWtlU3RhdHVzKGZhbHNlKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCh7IG5hbWUsIGFib3V0IH0pIHtcbiAgZWRpdFByb2ZpbGVQb3B1cC5zZXRMb2FkaW5nKHRydWUpO1xuICByZXR1cm4gYXBpXG4gICAgLnVwZGF0ZVByb2ZpbGVJbmZvKG5hbWUsIGFib3V0KVxuICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge30pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGROZXdDYXJkU3VibWl0KGNhcmREYXRhKSB7XG4gIGFwaVxuICAgIC5hZGRDYXJkKGNhcmREYXRhKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKHJlcyk7XG4gICAgICAvLyBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChjYXJkRGF0YSk7XG4gICAgICBjYXJkTGlzdC5hZGRJdGVtKGNyZWF0ZUNhcmQocmVzKSk7XG4gICAgICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xufVxuXG4vL0NvbmZpcm0gRGVsZXRlIFBvcHVwIFJlbmRlclxuXG5jb25zdCBjb25maXJtRGVsZXRlID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNjb25maXJtLW1vZGFsXCIpO1xuY29uZmlybURlbGV0ZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVCdXR0b24oY2FyZCkge1xuICAvLyBjb25zb2xlLmxvZyhcIkRlbGV0ZSBidXR0b24gY2xpY2tlZFwiKTtcbiAgY29uZmlybURlbGV0ZS5vcGVuKCk7XG4gIC8vIGNvbnNvbGUubG9nKGNhcmQuX2lkKTtcbiAgY29uZmlybURlbGV0ZS5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNvbmZpcm1EZWxldGUuY2xvc2UoKTtcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVDYXJkKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIH0pO1xuICB9KTtcbiAgY29uc29sZS5sb2coY2FyZCk7XG59XG5cbi8vSGFuZGxlIFByb2ZpbGUgUGljIFN1Ym1pdFxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBzZXRCdXR0b25UZXh0KGF2YXRhck1vZGFsQnV0dG9uLCBcIlNhdmluZy4uLlwiKTtcbiAgY29uc29sZS5sb2coaW5wdXRWYWx1ZXMpO1xuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKGlucHV0VmFsdWVzLmxpbmspXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihpbnB1dFZhbHVlcy5saW5rKTtcbiAgICAgIGF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKS5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgc2V0QnV0dG9uVGV4dChhdmF0YXJNb2RhbEJ1dHRvbiwgXCJTYXZlXCIpO1xuICAgICAgfSk7XG4gICAgfSk7XG59XG5cbi8vRVZFTlQgTElTVEVORVJTLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxucHJvZmlsZUltYWdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG5wcm9maWxlSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYXZhdGFyUG9wdXAub3BlbigpO1xuICBlZGl0UHJvZmlsZVBpY3R1cmVWYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuam9iO1xuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIC8vIHVzZXJJbmZvLmdldFVzZXJJbmZvO1xufSk7XG5cbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xuXG4vL0Zvcm0gVmFsaWRhdG9ycy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGFkZENhcmRGb3JtKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZmlsZUVkaXRGb3JtKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZWRpdFByb2ZpbGVQaWN0dXJlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIGNvbmZpZyxcbiAgZWRpdFByb2ZpbGVQaWN0dXJlRm9ybVxuKTtcbmVkaXRQcm9maWxlUGljdHVyZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8vTmV3IENhcmQgUG9wdXAgUmVuZGVyXG5cbmNvbnN0IG5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVBZGROZXdDYXJkU3VibWl0XG4pO1xubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vRWRpdCBQcm9maWxlIFBvcHVwIFJlbmRlclxuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuKTtcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy9Qcm9maWxlIFBpYyBQb3B1cFxuXG5jb25zdCBhdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLXBpY3R1cmUtbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdFxuKTtcbmF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gYWJvdXQ7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLmJhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgX2NoZWNrU2VydmVyUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvY2FyZHNcIiwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XG4gIH1cblxuICAvL2dldCB1c2VyIGluZm9cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL3VzZXJzL21lXCIsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgLy91cGRhdGUgcHJvZmlsZSBpbmZvIFBBVENIIC91c2Vycy9tZVxuICB1cGRhdGVQcm9maWxlSW5mbyhuYW1lLCBhYm91dCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgYWJvdXQgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcbiAgfVxuXG4gIC8vdXBkYXRlIGF2YXRhciBQQVRDSCAvdXNlcnMvbWUvYXZhdGFyXG4gIHVwZGF0ZUF2YXRhcih1cmwpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXI6IHVybCB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xuICB9XG5cbiAgLy9DQVJEIFJPVVRFUy0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vY3JlYXRlIGEgY2FyZCBQT1NUIC9jYXJkc1xuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIFwiL2NhcmRzXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWU6IG5hbWUsIGxpbms6IGxpbmsgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcbiAgfVxuXG4gIC8vZGVsZXRlIGEgY2FyZCBERUxFVEUgL2NhcmRzLzpjYXJkSWRcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgYC9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIF9pZDogY2FyZElkLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZUxpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMuYmFzZVVybCArIGAvY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tTZXJ2ZXJSZXNwb25zZSk7XG4gIH1cblxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xuICB9XG4gIC8vbGlrZSBhIGNhcmQgUFVUIC9jYXJkcy86Y2FyZElkL2xpa2VzXG4gIC8vIGxpa2VDYXJkKGNhcmRJZCwgX2lzTGlrZWQpIHtcbiAgLy8gICByZXR1cm4gZmV0Y2godGhpcy5iYXNlVXJsICsgYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gIC8vICAgICBtZXRob2Q6IF9pc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gIC8vICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gIC8vICAgfSkudGhlbih0aGlzLl9jaGVja1NlcnZlclJlc3BvbnNlKTtcbiAgLy8gfVxuXG4gIC8vIC8vZGlzbGlrZSBhIGNhcmQgREVMRVRFIC9jYXJkcy86Y2FyZElkL2xpa2VzXG4gIC8vIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xuICAvLyAgIHJldHVybiBmZXRjaCh0aGlzLmJhc2VVcmwgKyBgL2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgLy8gICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgLy8gICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgLy8gICB9KS50aGVuKHRoaXMuX2NoZWNrU2VydmVyUmVzcG9uc2UpO1xuICAvLyB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cblxuLy8gSXQgaGFzIGFuIG9iamVjdCB3aXRoIHR3byBwcm9wZXJ0aWVzIChpdGVtcyBhbmQgcmVuZGVyZXIpIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXIgb2YgdGhlIGNvbnN0cnVjdG9yLiBUaGUgaXRlbXMgcHJvcGVydHkgc2VydmVzIGFzIGFuIGFycmF5IG9mIGRhdGEsIHdoaWNoIHlvdSBuZWVkIHRvIGFkZCBvbiBhIHBhZ2Ugd2hlbiBpbml0aWFsaXppbmcgdGhlIGNsYXNzLiBUaGUgcmVuZGVyZXIgcHJvcGVydHkgaXMgYSBmdW5jdGlvbiByZXNwb25zaWJsZSBmb3IgY3JlYXRpbmcgYW5kIHJlbmRlcmluZyBkYXRhIG9uIGEgcGFnZS5cbi8vIFRoZSBzZWNvbmQgcGFyYW1ldGVyIHNob3VsZCBiZSBhIENTUyBjbGFzcyBzZWxlY3RvciB3aGVyZSB5b3UnbGwgYWRkIHRoZSBjYXJkIGVsZW1lbnRzLlxuLy8gSXQgc3RvcmVzIGEgcHVibGljIG1ldGhvZCBuYW1lZCByZW5kZXJJdGVtcygpIHRoYXQgcmVuZGVycyBhbGwgZWxlbWVudHMgb24gdGhlIHBhZ2UuIFRoZSByZW5kZXJlcigpIGZ1bmN0aW9uIHdpbGwgcmVuZGVyIGVhY2ggZWxlbWVudCBvbiBhIHBhZ2UuXG4vLyBJdCBzdG9yZXMgYSBwdWJsaWMgbWV0aG9kIG5hbWVkIGFkZEl0ZW0oKSB0aGF0IHRha2VzIGEgRE9NIGVsZW1lbnQgYW5kIGFkZHMgaXQgdG8gdGhlIGNvbnRhaW5lci5cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIlxuICAgICk7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3RpdGxlXCIpO1xuICB9XG5cbiAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNyYyA9IGxpbms7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlLmFsdCA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jb25maXJtRGVsZXRlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9jb25maXJtRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsIiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWwiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJxdWVyeVNlbGVjdG9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwicmVtb3ZlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJldmVyeSIsImlucHV0IiwicmVzZXRWYWxpZGF0aW9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9zdWJtaXRCdXR0b25UZXh0IiwicmVzZXQiLCJnZXRJbnB1dFZhbHVlcyIsImlucHV0cyIsImRhdGEiLCJuYW1lIiwidmFsdWUiLCJzZXRMb2FkaW5nIiwiaXNMb2FkaW5nIiwiQ2FyZCIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQnV0dG9uIiwiaGFuZGxlTGlrZUNsaWNrIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2xpa2VCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJoYW5kbGVMaWtlSWNvbiIsIl9jYXJkSW1hZ2UiLCJ0b2dnbGUiLCJ1cGRhdGVMaWtlZCIsInNldExpa2VTdGF0dXMiLCJnZXRWaWV3IiwicmVuZGVyQ2FyZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJfY2FyZFRpdGxlIiwiYWx0Iiwic3JjIiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGROZXdDYXJkQnV0dG9uIiwiYWRkQ2FyZEZvcm0iLCJlZGl0UHJvZmlsZVBpY3R1cmVGb3JtIiwicHJvZmlsZUVkaXRGb3JtIiwicHJvZmlsZU5hbWVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUltYWdlIiwicHJvZmlsZUltYWdlQnV0dG9uIiwiYXZhdGFyTW9kYWxCdXR0b24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyIiwiX25hbWVFbGVtZW50IiwiX2Fib3V0RWxlbWVudCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJzZXRVc2VyQXZhdGFyIiwiYXBpIiwib3B0aW9ucyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2NoZWNrU2VydmVyUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwidXBkYXRlUHJvZmlsZUluZm8iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZUF2YXRhciIsInVybCIsImFkZENhcmQiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwidXBkYXRlTGlrZSIsInJlbW92ZUxpa2UiLCJhdXRob3JpemF0aW9uIiwiY2FyZExpc3QiLCJzZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZERhdGEiLCJjcmVhdGVDYXJkIiwic2V0QnV0dG9uVGV4dCIsImJ1dHRvbiIsInRleHQiLCJjYXJkIiwiaW1hZ2VQb3B1cCIsImhhbmRsZUNhcmRMaWtlIiwicmV2ZXJzZSIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVyciIsImVycm9yIiwidXNlckRhdGEiLCJfcHJldmlld0ltYWdlIiwiX2ltYWdlQ2FwdGlvbiIsImNvbmZpcm1EZWxldGUiLCJfY29uZmlybURlbGV0ZSIsIl9oYW5kbGVGb3JtU3VibWl0Iiwic2V0U3VibWl0QWN0aW9uIiwiYXZhdGFyUG9wdXAiLCJlZGl0UHJvZmlsZVBpY3R1cmVWYWxpZGF0b3IiLCJlZGl0UHJvZmlsZVBvcHVwIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwibmV3Q2FyZFBvcHVwIiwiZmluYWxseSIsImlucHV0VmFsdWVzIl0sInNvdXJjZVJvb3QiOiIifQ==